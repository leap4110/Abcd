%MACRO CONSOLIDATE_DISTINCT(TABLE=, FIELDS=);
   %LOCAL I FIELD MERGE_LIST;
   
   /* STEP 1: GET DISTINCT VALUES FOR ALL FIELDS IN ONE PROC FREQ */
   PROC FREQ DATA=&TABLE NOPRINT;
      %DO I=1 %TO %SYSFUNC(COUNTW(&FIELDS));
         %LET FIELD = %SCAN(&FIELDS, &I);
         TABLES &FIELD / OUT=FREQ_&FIELD(KEEP=&FIELD);
      %END;
   RUN;
   
   /* STEP 2: ADD ROW NUMBERS TO EACH DATASET */
   %DO I=1 %TO %SYSFUNC(COUNTW(&FIELDS));
      %LET FIELD = %SCAN(&FIELDS, &I);
      
      DATA FREQ_&FIELD;
         SET FREQ_&FIELD;
         _ROW = _N_;
      RUN;
   %END;
   
   /* STEP 3: BUILD MERGE LIST */
   %LET MERGE_LIST = ;
   %DO I=1 %TO %SYSFUNC(COUNTW(&FIELDS));
      %LET FIELD = %SCAN(&FIELDS, &I);
      %LET MERGE_LIST = &MERGE_LIST FREQ_&FIELD;
   %END;
   
   /* STEP 4: MERGE ALL DATASETS */
   DATA CONSOLIDATED_DISTINCT;
      MERGE &MERGE_LIST;
      BY _ROW;
      DROP _ROW;
   RUN;
   
   PROC PRINT DATA=CONSOLIDATED_DISTINCT;
      TITLE "CONSOLIDATED DISTINCT VALUES";
   RUN;
%MEND;

%CONSOLIDATE_DISTINCT(
   TABLE=BUSINESS_TABLE, 
   FIELDS=FIELD1 FIELD2 FIELD3 STATUS REGION
);
