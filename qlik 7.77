Here's comprehensive field-by-field validation code comparing source to consolidated tables:

```sas
/*------------------------------------------------------------------------------------------------------------------------
DETAILED FIELD-BY-FIELD VALIDATION - Source vs Consolidated Tables
-------------------------------------------------------------------------------------------------------------------------*/

%MACRO DETAILED_VALIDATION (QTR);

/* Validation 1: SA3CD2021 - Geographic Distribution */
PROC SQL;
	TITLE "SA3CD2021 Validation - Quarter &QTR.";
	SELECT 
		 'Source: BT_PMTS_DELIVERED' AS Table_Source
		,SA3CD2021
		,COUNT(DISTINCT PRSNWITHDSBLTYID) AS Unique_Participants FORMAT=COMMA12.0
		,SUM(SUPP_DEL_COST) AS Total_Payments FORMAT=DOLLAR15.2
	FROM OUTBTD.BT_PMTS_DELIVERED&QTR.
	WHERE PMTRQSTPRVDRABN IS NOT NULL 
		AND PMTRQSTPRVDRABN NOT IN ('', ' ') 
		AND PMTRQSTPRVDRABN NOT IN ('DRCTE', 'EXCLS', 'ONLIN', 'REIMB', 'DSBLT', 'NOABN', 'OVRSE')
	GROUP BY SA3CD2021
	ORDER BY Total_Payments DESC;
QUIT;

PROC SQL;
	SELECT 
		 'Consolidated: CONSOLIDATED_FACT' AS Table_Source
		,SA3CD2021
		,COUNT(DISTINCT PARTICIPANT_KEY) AS Unique_Participants FORMAT=COMMA12.0
		,SUM(SUPP_DEL_COST) AS Total_Payments FORMAT=DOLLAR15.2
	FROM OUTPRVAP.CONSOLIDATED_FACT_&QTR.
	GROUP BY SA3CD2021
	ORDER BY Total_Payments DESC;
QUIT;

/* Validation 2: PRIMARY_DISABILITY - By Participant */
PROC SQL;
	TITLE "Primary Disability Validation - Quarter &QTR.";
	SELECT 
		 'Source: BT_PMTS_DELIVERED' AS Table_Source
		,NDISDSBLTYGRPNM AS PRIMARY_DISABILITY
		,COUNT(DISTINCT PRSNWITHDSBLTYID) AS Unique_Participants FORMAT=COMMA12.0
		,SUM(SUPP_DEL_COST) AS Total_Payments FORMAT=DOLLAR15.2
		,AVG(SUPP_DEL_COST) AS Avg_Payment FORMAT=DOLLAR12.2
	FROM OUTBTD.BT_PMTS_DELIVERED&QTR.
	WHERE PMTRQSTPRVDRABN IS NOT NULL 
		AND PMTRQSTPRVDRABN NOT IN ('', ' ') 
		AND PMTRQSTPRVDRABN NOT IN ('DRCTE', 'EXCLS', 'ONLIN', 'REIMB', 'DSBLT', 'NOABN', 'OVRSE')
	GROUP BY NDISDSBLTYGRPNM
	ORDER BY Total_Payments DESC;
QUIT;

PROC SQL;
	SELECT 
		 'Consolidated: CONSOLIDATED_FACT' AS Table_Source
		,PRIMARY_DISABILITY
		,COUNT(DISTINCT PARTICIPANT_KEY) AS Unique_Participants FORMAT=COMMA12.0
		,SUM(SUPP_DEL_COST) AS Total_Payments FORMAT=DOLLAR15.2
		,AVG(SUPP_DEL_COST) AS Avg_Payment FORMAT=DOLLAR12.2
	FROM OUTPRVAP.CONSOLIDATED_FACT_&QTR.
	GROUP BY PRIMARY_DISABILITY
	ORDER BY Total_Payments DESC;
QUIT;

/* Validation 3: AGE_GROUP - By Participant and Payment */
PROC SQL;
	TITLE "Age Group Validation - Quarter &QTR.";
	SELECT 
		 'Source: BT_PMTS_DELIVERED' AS Table_Source
		,AGE_GROUP
		,COUNT(DISTINCT PRSNWITHDSBLTYID) AS Unique_Participants FORMAT=COMMA12.0
		,COUNT(*) AS Total_Records FORMAT=COMMA12.0
		,SUM(SUPP_DEL_COST) AS Total_Payments FORMAT=DOLLAR15.2
	FROM OUTBTD.BT_PMTS_DELIVERED&QTR.
	WHERE PMTRQSTPRVDRABN IS NOT NULL 
		AND PMTRQSTPRVDRABN NOT IN ('', ' ') 
		AND PMTRQSTPRVDRABN NOT IN ('DRCTE', 'EXCLS', 'ONLIN', 'REIMB', 'DSBLT', 'NOABN', 'OVRSE')
	GROUP BY AGE_GROUP
	ORDER BY AGE_GROUP;
QUIT;

PROC SQL;
	SELECT 
		 'Consolidated: CONSOLIDATED_FACT' AS Table_Source
		,AGE_GROUP
		,COUNT(DISTINCT PARTICIPANT_KEY) AS Unique_Participants FORMAT=COMMA12.0
		,COUNT(*) AS Total_Records FORMAT=COMMA12.0
		,SUM(SUPP_DEL_COST) AS Total_Payments FORMAT=DOLLAR15.2
	FROM OUTPRVAP.CONSOLIDATED_FACT_&QTR.
	GROUP BY AGE_GROUP
	ORDER BY AGE_GROUP;
QUIT;

/* Validation 4: GENDER - Distribution Check */
PROC SQL;
	TITLE "Gender Validation - Quarter &QTR.";
	SELECT 
		 'Source: BT_PMTS_DELIVERED' AS Table_Source
		,GENDER
		,COUNT(DISTINCT PRSNWITHDSBLTYID) AS Unique_Participants FORMAT=COMMA12.0
		,SUM(SUPP_DEL_COST) AS Total_Payments FORMAT=DOLLAR15.2
		,CALCULATED Total_Payments / (SELECT SUM(SUPP_DEL_COST) FROM OUTBTD.BT_PMTS_DELIVERED&QTR. 
			WHERE PMTRQSTPRVDRABN IS NOT NULL) AS Pct_of_Total FORMAT=PERCENT8.2
	FROM OUTBTD.BT_PMTS_DELIVERED&QTR.
	WHERE PMTRQSTPRVDRABN IS NOT NULL 
		AND PMTRQSTPRVDRABN NOT IN ('', ' ') 
		AND PMTRQSTPRVDRABN NOT IN ('DRCTE', 'EXCLS', 'ONLIN', 'REIMB', 'DSBLT', 'NOABN', 'OVRSE')
	GROUP BY GENDER;
QUIT;

PROC SQL;
	SELECT 
		 'Consolidated: CONSOLIDATED_FACT' AS Table_Source
		,GENDER
		,COUNT(DISTINCT PARTICIPANT_KEY) AS Unique_Participants FORMAT=COMMA12.0
		,SUM(SUPP_DEL_COST) AS Total_Payments FORMAT=DOLLAR15.2
		,CALCULATED Total_Payments / (SELECT SUM(SUPP_DEL_COST) FROM OUTPRVAP.CONSOLIDATED_FACT_&QTR.) 
			AS Pct_of_Total FORMAT=PERCENT8.2
	FROM OUTPRVAP.CONSOLIDATED_FACT_&QTR.
	GROUP BY GENDER;
QUIT;

/* Validation 5: SUPPCATCD - Support Category Analysis */
PROC SQL;
	TITLE "Support Category Validation - Quarter &QTR.";
	SELECT 
		 'Source: BT_PMTS_DELIVERED' AS Table_Source
		,SUPPCATCD
		,COUNT(DISTINCT PRSNWITHDSBLTYID) AS Unique_Participants FORMAT=COMMA12.0
		,COUNT(*) AS Payment_Count FORMAT=COMMA12.0
		,SUM(SUPP_DEL_COST) AS Total_Payments FORMAT=DOLLAR15.2
	FROM OUTBTD.BT_PMTS_DELIVERED&QTR.
	WHERE PMTRQSTPRVDRABN IS NOT NULL 
		AND PMTRQSTPRVDRABN NOT IN ('', ' ') 
		AND PMTRQSTPRVDRABN NOT IN ('DRCTE', 'EXCLS', 'ONLIN', 'REIMB', 'DSBLT', 'NOABN', 'OVRSE')
	GROUP BY SUPPCATCD
	ORDER BY Total_Payments DESC;
QUIT;

PROC SQL;
	SELECT 
		 'Consolidated: CONSOLIDATED_FACT' AS Table_Source
		,SUPPCATCD
		,COUNT(DISTINCT PARTICIPANT_KEY) AS Unique_Participants FORMAT=COMMA12.0
		,COUNT(*) AS Payment_Count FORMAT=COMMA12.0
		,SUM(SUPP_DEL_COST) AS Total_Payments FORMAT=DOLLAR15.2
	FROM OUTPRVAP.CONSOLIDATED_FACT_&QTR.
	GROUP BY SUPPCATCD
	ORDER BY Total_Payments DESC;
QUIT;

/* Validation 6: MGTTYPDESC_NEW - Management Type */
PROC SQL;
	TITLE "Management Type Validation - Quarter &QTR.";
	SELECT 
		 'Source: BT_PMTS_DELIVERED' AS Table_Source
		,MGTTYPDESC_NEW
		,COUNT(DISTINCT PRSNWITHDSBLTYID) AS Unique_Participants FORMAT=COMMA12.0
		,SUM(SUPP_DEL_COST) AS Total_Payments FORMAT=DOLLAR15.2
	FROM OUTBTD.BT_PMTS_DELIVERED&QTR.
	WHERE PMTRQSTPRVDRABN IS NOT NULL 
		AND PMTRQSTPRVDRABN NOT IN ('', ' ') 
		AND PMTRQSTPRVDRABN NOT IN ('DRCTE', 'EXCLS', 'ONLIN', 'REIMB', 'DSBLT', 'NOABN', 'OVRSE')
	GROUP BY MGTTYPDESC_NEW;
QUIT;

PROC SQL;
	SELECT 
		 'Consolidated: CONSOLIDATED_FACT' AS Table_Source
		,MGTTYPDESC_NEW
		,COUNT(DISTINCT PARTICIPANT_KEY) AS Unique_Participants FORMAT=COMMA12.0
		,SUM(SUPP_DEL_COST) AS Total_Payments FORMAT=DOLLAR15.2
	FROM OUTPRVAP.CONSOLIDATED_FACT_&QTR.
	GROUP BY MGTTYPDESC_NEW;
QUIT;

/* Validation 7: Cross-Tabulation - Disability by Age Group */
PROC SQL;
	TITLE "Cross-Tab: Disability x Age Group - Quarter &QTR.";
	SELECT 
		 'Source Table' AS Source
		,NDISDSBLTYGRPNM AS PRIMARY_DISABILITY
		,AGE_GROUP
		,COUNT(DISTINCT PRSNWITHDSBLTYID) AS Participants FORMAT=COMMA8.0
		,SUM(SUPP_DEL_COST) AS Total_Payments FORMAT=DOLLAR12.2
	FROM OUTBTD.BT_PMTS_DELIVERED&QTR.
	WHERE PMTRQSTPRVDRABN IS NOT NULL 
		AND PMTRQSTPRVDRABN NOT IN ('', ' ') 
		AND PMTRQSTPRVDRABN NOT IN ('DRCTE', 'EXCLS', 'ONLIN', 'REIMB', 'DSBLT', 'NOABN', 'OVRSE')
	GROUP BY NDISDSBLTYGRPNM, AGE_GROUP
	ORDER BY PRIMARY_DISABILITY, AGE_GROUP;
QUIT;

PROC SQL;
	SELECT 
		 'Consolidated Table' AS Source
		,PRIMARY_DISABILITY
		,AGE_GROUP
		,COUNT(DISTINCT PARTICIPANT_KEY) AS Participants FORMAT=COMMA8.0
		,SUM(SUPP_DEL_COST) AS Total_Payments FORMAT=DOLLAR12.2
	FROM OUTPRVAP.CONSOLIDATED_FACT_&QTR.
	GROUP BY PRIMARY_DISABILITY, AGE_GROUP
	ORDER BY PRIMARY_DISABILITY, AGE_GROUP;
QUIT;

/* Summary Validation Report */
PROC SQL;
	TITLE "Summary Validation Report - Quarter &QTR.";
	SELECT 
		 'Overall Totals' AS Validation_Check
		,(SELECT COUNT(*) FROM OUTBTD.BT_PMTS_DELIVERED&QTR. 
			WHERE PMTRQSTPRVDRABN IS NOT NULL AND PMTRQSTPRVDRABN NOT IN ('', ' ') 
			AND PMTRQSTPRVDRABN NOT IN ('DRCTE', 'EXCLS', 'ONLIN', 'REIMB', 'DSBLT', 'NOABN', 'OVRSE')) 
			AS Source_Records FORMAT=COMMA12.0
		,(SELECT COUNT(*) FROM OUTPRVAP.CONSOLIDATED_FACT_&QTR.) AS Consolidated_Records FORMAT=COMMA12.0
		,(SELECT COUNT(DISTINCT PRSNWITHDSBLTYID) FROM OUTBTD.BT_PMTS_DELIVERED&QTR. 
			WHERE PMTRQSTPRVDRABN IS NOT NULL AND PMTRQSTPRVDRABN NOT IN ('', ' ') 
			AND PMTRQSTPRVDRABN NOT IN ('DRCTE', 'EXCLS', 'ONLIN', 'REIMB', 'DSBLT', 'NOABN', 'OVRSE')) 
			AS Source_Participants FORMAT=COMMA12.0
		,(SELECT COUNT(DISTINCT PARTICIPANT_KEY) FROM OUTPRVAP.CONSOLIDATED_FACT_&QTR.) 
			AS Consolidated_Participants FORMAT=COMMA12.0
		,(SELECT SUM(SUPP_DEL_COST) FROM OUTBTD.BT_PMTS_DELIVERED&QTR. 
			WHERE PMTRQSTPRVDRABN IS NOT NULL AND PMTRQSTPRVDRABN NOT IN ('', ' ') 
			AND PMTRQSTPRVDRABN NOT IN ('DRCTE', 'EXCLS', 'ONLIN', 'REIMB', 'DSBLT', 'NOABN', 'OVRSE')) 
			AS Source_Payments FORMAT=DOLLAR15.2
		,(SELECT SUM(SUPP_DEL_COST) FROM OUTPRVAP.CONSOLIDATED_FACT_&QTR.) 
			AS Consolidated_Payments FORMAT=DOLLAR15.2
	FROM (SELECT 1 AS dummy);
QUIT;

%MEND DETAILED_VALIDATION;

/* Run for each quarter */
%DETAILED_VALIDATION (_2324_Q1);
%DETAILED_VALIDATION (_2324_Q2);
%DETAILED_VALIDATION (_2324_Q3);
%DETAILED_VALIDATION (_2324_Q4);
%DETAILED_VALIDATION (_2425_Q1);
%DETAILED_VALIDATION (_2425_Q2);
```

This validation code checks:

1. **SA3CD2021** - Geographic distribution of participants and payments
2. **PRIMARY_DISABILITY** - Disability breakdown with participant counts
3. **AGE_GROUP** - Age distribution validation
4. **GENDER** - Gender split with percentages
5. **SUPPCATCD** - Support category totals
6. **MGTTYPDESC_NEW** - Management type analysis
7. **Cross-tabulation** - Disability by Age Group for deeper validation
8. **Summary Report** - Overall comparison

Each validation compares source vs consolidated to ensure no data loss or duplication during transformation.
